<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples - Realtime  · AuditoryStimuli.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AuditoryStimuli.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../examples/">Examples - Offline</a></li><li class="is-active"><a class="tocitem" href>Examples - Realtime </a><ul class="internal"><li><a class="tocitem" href="#Set-up-the-signal-pipeline-components"><span>Set up the signal pipeline components</span></a></li><li><a class="tocitem" href="#Run-the-real-time-audio-pipeline"><span>Run the real-time audio pipeline</span></a></li><li><a class="tocitem" href="#Verify-the-output"><span>Verify the output</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples - Realtime </a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples - Realtime </a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rob-luke/AuditoryStimuli.jl/blob/master/docs/src/examples-realtime.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Realtime-Audio-Processing"><a class="docs-heading-anchor" href="#Realtime-Audio-Processing">Realtime Audio Processing</a><a id="Realtime-Audio-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Realtime-Audio-Processing" title="Permalink"></a></h1><p>Here we demonstrate how to stream audio and apply modifications to the signal. We will vary the amplitude of the signal and apply a filter during a limited time window.</p><p>The real-time processing consist of a source, modifiers, and a sink. Sources generate the raw signal. Modifiers alter the signal they are applied to. Sinks are a destination for the signals, typically a sound card, but in this example we use a buffer.</p><p>First we load the required packages and specify the sample rate and number of audio channels.</p><pre><code class="language-">using AuditoryStimuli, Unitful, Plots, Pipe

gr()
Plots.reset_defaults()

sample_rate = 48000
audio_channels = 2;
source_rms = 0.2</code></pre><h2 id="Set-up-the-signal-pipeline-components"><a class="docs-heading-anchor" href="#Set-up-the-signal-pipeline-components">Set up the signal pipeline components</a><a id="Set-up-the-signal-pipeline-components-1"></a><a class="docs-heading-anchor-permalink" href="#Set-up-the-signal-pipeline-components" title="Permalink"></a></h2><p>Next we open a connection with a sink. This would typically be a sound card, but that is not possible on a web site. Instead, for this website example we use a dummy sink.</p><pre><code class="language-">sink = DummySampleSink(Float64, sample_rate, num_channels)

# But on a real system you would use something like
# a = PortAudio.devices()
# sink = PortAudioStream(a[3], 0, 2)</code></pre><p>We also need a source. Here we use a simple white noise source.</p><pre><code class="language-">source = NoiseSource(Float64, Fs, num_channels, source_rms)</code></pre><p>And we will apply one signal modifier. The first modifier adjusts the amplitude of the signal. We want the signal to ramp from silent to full intensity, so we set the initial value to 0.0 and the target value to 1.0, and the maximum change per frame to 0.01.</p><pre><code class="language-">amp = Amplification(0,0, 1.0, 0.01)</code></pre><h2 id="Run-the-real-time-audio-pipeline"><a class="docs-heading-anchor" href="#Run-the-real-time-audio-pipeline">Run the real-time audio pipeline</a><a id="Run-the-real-time-audio-pipeline-1"></a><a class="docs-heading-anchor-permalink" href="#Run-the-real-time-audio-pipeline" title="Permalink"></a></h2><p>We will now read from the noise source in 1/100th second frames. This is then passed through the signal amplifier, then sent to the sink.</p><pre><code class="language-">for frame = 1:300
    @pipe read(source, 0.01u&quot;s&quot;) |&gt; modify(amp, _) |&gt; write(sink, _)
end</code></pre><h2 id="Verify-the-output"><a class="docs-heading-anchor" href="#Verify-the-output">Verify the output</a><a id="Verify-the-output-1"></a><a class="docs-heading-anchor-permalink" href="#Verify-the-output" title="Permalink"></a></h2><pre><code class="language-">display(plot(sink.buf))</code></pre><p>Next we can modify the amplification and push another 2 seconds through the pipeline.</p><pre><code class="language-">for frame = 1:200
    @pipe read(source, 0.01u&quot;s&quot;) |&gt; modify(amp, _) |&gt; write(sink, _)
end</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples - Offline</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 26 February 2021 09:58">Friday 26 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
